<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Streamify - Browse</title>
  <link rel="stylesheet" href="style.css" />
  <script defer src="script.js"></script>
</head>
<body class="browse-page">
  <!-- NAVBAR -->
  <nav class="navbar">
    <div class="logo" style="display:flex;align-items:center;gap:10px;">
      <span style="font-weight:600;color:#ff00aa;">Streamify</span>
    </div>

    <ul class="nav-links">
      <li><a href="Homepage.html">Home</a></li>
      <li><a href="browse.html" class="active">Browse</a></li>
      <li><a href="playlists.html">Playlist</a></li>
      <li><a href="favorites.html">Favorites</a></li>
      <li><a href="accounts.html">Account</a></li>
    </ul>

    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="Search songs, artists, or genres..." />
    </div>
  </nav>

  <!-- MAIN CONTENT -->
  <div class="container">
    <h1>Discover New Music üé∂</h1>
    <div id="searchResults" class="song-grid" style="display:none; margin-top:1em;"></div>

    <!-- Dynamic Genre Sections -->
    <div id="genreSections"></div>
  </div>

  <!-- Music Player -->
<div class="music-player">
  <div class="player-content">
    <div class="now-section">
      <img id="albumCover" src="https://via.placeholder.com/60" alt="Album Cover" />
      <div>
        <p id="nowPlaying">Now Playing: None</p>
        <p id="artistName" style="font-size:0.9rem; color:#bbb;">‚Äî</p>
      </div>
    </div>

    <div class="controls">
      <button id="prevBtn">‚èÆÔ∏è</button>
      <button id="playPauseBtn">‚ñ∂Ô∏è</button>
      <button id="nextBtn">‚è≠Ô∏è</button>

      <!-- Progress Bar -->
      <input type="range" id="progressBar" value="0" min="0" max="100" step="0.1" style="flex:1; margin:0 10px;">

     <!-- Volume Control -->
<div class="volume-container" style="display:flex; align-items:center; gap:8px; margin-left:10px;">
  <span id="volumeIcon" style="font-size:1.2rem; cursor:pointer;">üîä</span>
  <input type="range" id="volumeControl" value="100" min="0" max="100" step="1" style="width:100px;">
</div>

  <!-- Like Button -->
  <button id="likeBtn" style="font-size:1.2rem; margin-left:10px; cursor:pointer;">ü§ç</button>
  </div>
</div>

  <!-- DYNAMIC GENRE SCRIPT -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const genreContainer = document.getElementById("genreSections");
      if (!window.songs) {
        console.error("‚ö†Ô∏è songs array not found");
        return;
      }

      // Group songs by genre
      const genres = {};
      songs.forEach(song => {
        if (!genres[song.genre]) genres[song.genre] = [];
        genres[song.genre].push(song);
      });

      // Create genre sections
      for (const genre in genres) {
        const section = document.createElement("div");
        section.className = "section box";
        section.innerHTML = `<h2>${genre}</h2><div class="song-grid"></div>`;
        const grid = section.querySelector(".song-grid");

        // Pick 3 random songs per genre
        const randomSongs = [...genres[genre]].sort(() => Math.random() - 0.5).slice(0, 3);
        randomSongs.forEach(song => {
          const card = document.createElement("div");
          card.classList.add("song-card");
          card.innerHTML = `
            <img src="${song.cover}" alt="${song.title}">
            <div class="song-info">
              <h4>${song.title}</h4>
              <p>${song.artist}</p>
              <button class="fav-btn">${song.favorite ? "üíñ" : "ü§ç"}</button>
            </div>
          `;
          
          // Play on click
          card.querySelector("img").addEventListener("click", () => {
            const idx = songs.indexOf(song);
            if (idx >= 0) {
              loadTrack(idx);
              playTrack();
              updateStats();
            }
          });

          // Favorite toggle
          const favBtn = card.querySelector(".fav-btn");
          favBtn.addEventListener("click", (e) => {
            e.stopPropagation();
            song.favorite = !song.favorite;
            favBtn.textContent = song.favorite ? "üíñ" : "ü§ç";
            updateStats();
            localStorage.setItem("songsData", JSON.stringify(songs));
          });

          grid.appendChild(card);
        });

        genreContainer.appendChild(section);
      }

      // --- SEARCH ---
      const searchInput = document.getElementById("searchInput");
      const searchResults = document.getElementById("searchResults");
      const sections = document.querySelectorAll(".section");

      searchInput.addEventListener("input", () => {
        const query = searchInput.value.toLowerCase().trim();

        if (query === "") {
          searchResults.style.display = "none";
          sections.forEach(sec => sec.style.display = "block");
          searchResults.innerHTML = "";
          return;
        }

        const filteredSongs = songs.filter(song =>
          song.title.toLowerCase().includes(query) ||
          song.artist.toLowerCase().includes(query) ||
          song.genre.toLowerCase().includes(query)
        );

        searchResults.innerHTML = "";
        if (filteredSongs.length === 0) {
          searchResults.innerHTML = "<p>No songs found üòî</p>";
        } else {
          filteredSongs.forEach(song => {
            const card = document.createElement("div");
            card.classList.add("song-card");
            card.innerHTML = `
              <img src="${song.cover}" alt="${song.title}">
              <div class="song-info">
                <h4>${song.title}</h4>
                <p>${song.artist}</p>
              </div>
            `;
            card.addEventListener("click", () => {
              const idx = songs.indexOf(song);
              loadTrack(idx);
              playTrack();
            });
            searchResults.appendChild(card);
          });
        }

        searchResults.style.display = "grid";
        sections.forEach(sec => sec.style.display = "none");
      });
    });
  </script>
</body>
</html>
